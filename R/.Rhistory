mut_mat_liver_1 <- mut_mat_sub + 0.0001
nmf_res <- extract_signatures(as.matrix(mut_mat_colon_1),rank=6,nrun=10)
colnames(nmf_res$signatures) <- c("DBS_LIV_A", "DBS_LIV_B","DBS_LIV_C", "DBS_LIV_D","DBS_LIV_E", "DBS_LIV_F")
rownames(nmf_res$contribution) <- c("DBS_LIV_A", "DBS_LIV_B","DBS_LIV_C", "DBS_LIV_D","DBS_LIV_E", "DBS_LIV_F")
signatures <- as.data.frame(nmf_res$signatures)
signatures <- sweep(signatures,2,(colSums(signatures)),`/`)
plot_dbs_contexts(signatures, condensed = TRUE)
total_signatures <- colSums(nmf_res$signatures)
abs_contribution <- nmf_res$contribution * total_signatures
abs_contribution <- as.data.frame(t(abs_contribution))
saveRDS(signatures,file = "/Users/avanhoeck/hpc/cuppen/projects/P0002_5FU_Healthy/WGS_clones/analysis/Analysis/Data/Sign_analysis/Signatures/MutationPatterns/denovo_DBS_colon_sign.rds")
signatures <- signatures %>% tibble::rownames_to_column("MutationType")
write.table(signatures, file = "/Users/avanhoeck/hpc/cuppen/projects/P0002_5FU_Healthy/WGS_clones/analysis/Analysis/Data/Sign_analysis/Signatures/MutationPatterns/denovo_DBS_colon_sign.txt",sep = "\t", col.names = NA,qmethod = "double", quote = FALSE)
abs_contribution <- tibble::rownames_to_column(abs_contribution, "sample_name_R")
saveRDS(abs_contribution,file = "/Users/avanhoeck/hpc/cuppen/projects/P0002_5FU_Healthy/WGS_clones/analysis/Analysis/Data/Sign_analysis/Signatures/MutationPatterns/enovo_DBS_colon_sign_contribution.rds")
write.table(abs_contribution, file = "/Users/avanhoeck/hpc/cuppen/projects/P0002_5FU_Healthy/WGS_clones/analysis/Analysis/Data/Sign_analysis/Signatures/MutationPatterns/denovo_DBS_colon_sign_contribution.txt",sep = "\t", col.names = NA,qmethod = "double", quote = FALSE)
saveRDS(signatures,file = "/Users/avanhoeck/hpc/cuppen/projects/P0002_5FU_Healthy/WGS_clones/analysis/Analysis/Data/Sign_analysis/Signatures/MutationPatterns/denovo_DBS_liver_sign.rds")
signatures <- signatures %>% tibble::rownames_to_column("MutationType")
write.table(signatures, file = "/Users/avanhoeck/hpc/cuppen/projects/P0002_5FU_Healthy/WGS_clones/analysis/Analysis/Data/Sign_analysis/Signatures/MutationPatterns/denovo_DBS_liver_sign.txt",sep = "\t", col.names = NA,qmethod = "double", quote = FALSE)
colnames(nmf_res$signatures) <- c("DBS_LIV_A", "DBS_LIV_B","DBS_LIV_C", "DBS_LIV_D","DBS_LIV_E", "DBS_LIV_F")
rownames(nmf_res$contribution) <- c("DBS_LIV_A", "DBS_LIV_B","DBS_LIV_C", "DBS_LIV_D","DBS_LIV_E", "DBS_LIV_F")
signatures <- as.data.frame(nmf_res$signatures)
signatures <- sweep(signatures,2,(colSums(signatures)),`/`)
plot_dbs_contexts(signatures, condensed = TRUE)
total_signatures <- colSums(nmf_res$signatures)
abs_contribution <- nmf_res$contribution * total_signatures
abs_contribution <- as.data.frame(t(abs_contribution))
saveRDS(signatures,file = "/Users/avanhoeck/hpc/cuppen/projects/P0002_5FU_Healthy/WGS_clones/analysis/Analysis/Data/Sign_analysis/Signatures/MutationPatterns/denovo_DBS_liver_sign.rds")
signatures <- signatures %>% tibble::rownames_to_column("MutationType")
write.table(signatures, file = "/Users/avanhoeck/hpc/cuppen/projects/P0002_5FU_Healthy/WGS_clones/analysis/Analysis/Data/Sign_analysis/Signatures/MutationPatterns/denovo_DBS_liver_sign.txt",sep = "\t", col.names = NA,qmethod = "double", quote = FALSE)
abs_contribution <- tibble::rownames_to_column(abs_contribution, "sample_name_R")
saveRDS(abs_contribution,file = "/Users/avanhoeck/hpc/cuppen/projects/P0002_5FU_Healthy/WGS_clones/analysis/Analysis/Data/Sign_analysis/Signatures/MutationPatterns/enovo_DBS_liver_sign_contribution.rds")
write.table(abs_contribution, file = "/Users/avanhoeck/hpc/cuppen/projects/P0002_5FU_Healthy/WGS_clones/analysis/Analysis/Data/Sign_analysis/Signatures/MutationPatterns/denovo_DBS_liver_sign_contribution.txt",sep = "\t", col.names = NA,qmethod = "double", quote = FALSE)
SBS_sign_colon <- readRDS(signatures,file = "/Users/avanhoeck/hpc/cuppen/projects/P0002_5FU_Healthy/WGS_clones/analysis/Analysis/Data/Sign_analysis/Signatures/MutationPatterns/denovo_SBS_colon_sign.rds")
DBS_sign_colon <- readRDS(signatures,file = "/Users/avanhoeck/hpc/cuppen/projects/P0002_5FU_Healthy/WGS_clones/analysis/Analysis/Data/Sign_analysis/Signatures/MutationPatterns/denovo_DBS_colon_sign.rds")
SBS_sign_liver <- readRDS(signatures,file = "/Users/avanhoeck/hpc/cuppen/projects/P0002_5FU_Healthy/WGS_clones/analysis/Analysis/Data/Sign_analysis/Signatures/MutationPatterns/denovo_SBS_liver_sign.rds")
DBS_sign_liver <- readRDS(signatures,file = "/Users/avanhoeck/hpc/cuppen/projects/P0002_5FU_Healthy/WGS_clones/analysis/Analysis/Data/Sign_analysis/Signatures/MutationPatterns/denovo_DBS_liver_sign.rds")
SBS_sign_colon
DBS_sign_colon
SBS_sign_liver
DBS_sign_liver
overview_data <- as.data.frame(read_xlsx("/Users/avanhoeck/hpc/cuppen/projects/P0002_5FU_Healthy/WGS_clones/analysis/Clinical_info/meta_data.xlsx",sheet = "Sheet1"))
colon_healthy_untreated_samples <- overview_data %>% dplyr::filter(Condition=="Healthy" & tissue =="Colon" & WGS_approach=="Organoid")%>% dplyr::pull(sample_name_R) %>% sort() %>% unique()
mut_mat_colon <- mut_mat[,colon_healthy_untreated_samples]
ssbs_Lee <- read.table("/Users/avanhoeck/hpc/cuppen/projects/P0002_5FU_Healthy/WGS_clones/analysis/Analysis/Data/Sign_analysis/Lee_signatures_colon/sbs_category_counts.txt",sep = "\t")
ssbs_Lee <- as.data.frame(t(ssbs_Lee))
rownames(ssbs_Lee) <-  tri_context
mut_mat_sub <- cbind(mut_mat_colon,ssbs_Lee)
mut_mat_sub_export <- tibble::rownames_to_column(mut_mat_sub, "MutationType")
write.table(mut_mat_sub_export, file = "/Users/avanhoeck/hpc/cuppen/projects/P0002_5FU_Healthy/WGS_clones/analysis/Analysis/Data/Sign_analysis/mutationMatrices/SBS_colon.txt",sep = "\t",qmethod = "double", quote = FALSE,row.names = FALSE)
saveRDS(mut_mat_sub,file = "/Users/avanhoeck/hpc/cuppen/projects/P0002_5FU_Healthy/WGS_clones/analysis/Analysis/Data/Sign_analysis/mutationMatrices/SBS_colon.rds")
dbs_counts_colon <- dbs_counts[,colon_healthy_untreated_samples]
dsbs_Lee <- read.table("/Users/avanhoeck/hpc/cuppen/projects/P0002_5FU_Healthy/WGS_clones/analysis/Analysis/Data/Sign_analysis/Lee_signatures_colon/dbs_category_counts.txt",sep = "\t")
dsbs_Lee <- as.data.frame(t(dsbs_Lee))
rownames(dsbs_Lee) <-  rownames(dbs_counts_colon)
dbs_counts_sub <- cbind(dbs_counts_colon,dsbs_Lee)
dbs_counts_export <- tibble::rownames_to_column(dbs_counts_sub, "MutationType")
dbs_counts_export$MutationType <- sub("\\_","\\>",dbs_counts_export$MutationType)
write.table(dbs_counts_export, file = "/Users/avanhoeck/hpc/cuppen/projects/P0002_5FU_Healthy/WGS_clones/analysis/Analysis/Data/Sign_analysis/mutationMatrices/DBS_colon.txt",sep = "\t",qmethod = "double", quote = FALSE,row.names = FALSE)
saveRDS(dbs_counts_sub,file = "/Users/avanhoeck/hpc/cuppen/projects/P0002_5FU_Healthy/WGS_clones/analysis/Analysis/Data/Sign_analysis/mutationMatrices/DBS_colon.rds")
dbs_counts_sub
mut_mat_colon_1 <- dbs_counts_sub + 0.0001
nmf_res <- extract_signatures(as.matrix(mut_mat_colon_1),rank=6,nrun=10)
colnames(nmf_res$signatures) <- c("DBS_COL_A", "DBS_COL_B","DBS_COL_C", "DBS_COL_D","DBS_COL_E", "DBS_COL_F")
rownames(nmf_res$contribution) <- c("DBS_COL_A", "DBS_COL_B","DBS_COL_C", "DBS_COL_D","DBS_COL_E", "DBS_COL_F")
signatures <- as.data.frame(nmf_res$signatures)
signatures <- sweep(signatures,2,(colSums(signatures)),`/`)
plot_dbs_contexts(signatures, condensed = TRUE)
total_signatures <- colSums(nmf_res$signatures)
abs_contribution <- nmf_res$contribution * total_signatures
abs_contribution <- as.data.frame(t(abs_contribution))
saveRDS(signatures,file = "/Users/avanhoeck/hpc/cuppen/projects/P0002_5FU_Healthy/WGS_clones/analysis/Analysis/Data/Sign_analysis/Signatures/MutationPatterns/denovo_DBS_colon_sign.rds")
signatures <- signatures %>% tibble::rownames_to_column("MutationType")
write.table(signatures, file = "/Users/avanhoeck/hpc/cuppen/projects/P0002_5FU_Healthy/WGS_clones/analysis/Analysis/Data/Sign_analysis/Signatures/MutationPatterns/denovo_DBS_colon_sign.txt",sep = "\t", col.names = NA,qmethod = "double", quote = FALSE)
abs_contribution <- tibble::rownames_to_column(abs_contribution, "sample_name_R")
saveRDS(abs_contribution,file = "/Users/avanhoeck/hpc/cuppen/projects/P0002_5FU_Healthy/WGS_clones/analysis/Analysis/Data/Sign_analysis/Signatures/MutationPatterns/enovo_DBS_colon_sign_contribution.rds")
write.table(abs_contribution, file = "/Users/avanhoeck/hpc/cuppen/projects/P0002_5FU_Healthy/WGS_clones/analysis/Analysis/Data/Sign_analysis/Signatures/MutationPatterns/denovo_DBS_colon_sign_contribution.txt",sep = "\t", col.names = NA,qmethod = "double", quote = FALSE)
SBS_sign_colon <- readRDS(signatures,file = "/Users/avanhoeck/hpc/cuppen/projects/P0002_5FU_Healthy/WGS_clones/analysis/Analysis/Data/Sign_analysis/Signatures/MutationPatterns/denovo_SBS_colon_sign.rds")
DBS_sign_colon <- readRDS(signatures,file = "/Users/avanhoeck/hpc/cuppen/projects/P0002_5FU_Healthy/WGS_clones/analysis/Analysis/Data/Sign_analysis/Signatures/MutationPatterns/denovo_DBS_colon_sign.rds")
SBS_sign_liver <- readRDS(signatures,file = "/Users/avanhoeck/hpc/cuppen/projects/P0002_5FU_Healthy/WGS_clones/analysis/Analysis/Data/Sign_analysis/Signatures/MutationPatterns/denovo_SBS_liver_sign.rds")
DBS_sign_liver <- readRDS(signatures,file = "/Users/avanhoeck/hpc/cuppen/projects/P0002_5FU_Healthy/WGS_clones/analysis/Analysis/Data/Sign_analysis/Signatures/MutationPatterns/denovo_DBS_liver_sign.rds")
SBS_sign_colon
DBS_sign_colon
SBS_sign_liver
DBS_sign_liver
#create a merged 5-FU and Pt COSMIC signature
Ptand5FUsign<-cbind(signatures[,c("SBS35")],rowSums(signatures[,c("SBS17b","SBS17a")])/2)
Ptand5FUsign <- sweep(Ptand5FUsign,2,(colSums(Ptand5FUsign)),`/`)
colnames(Ptand5FUsign) <- c("SBS35","SBS17")
Ptand5FUsign<-cbind(Ptand5FUsign[,c("SBS35","SBS17")],rowSums(Ptand5FUsign[,c("SBS35","SBS17")])/2)
colnames(Ptand5FUsign) <- c("Platinum","5-FU","Platinum + 5-FU")
Ptand5FUsign <- sweep(Ptand5FUsign,2,(colSums(Ptand5FUsign)),`/`)
tt <- cbind(nmf_res$signatures[,c("SBS_J")],Ptand5FUsign)
colnames(tt) <- c("SBS_J","Platinum","5-FU","Platinum + 5-FU")
signatures
get_known_signatures()
#create a merged 5-FU and Pt COSMIC signature
signatures = get_known_signatures()
Ptand5FUsign<-cbind(signatures[,c("SBS35")],rowSums(signatures[,c("SBS17b","SBS17a")])/2)
Ptand5FUsign <- sweep(Ptand5FUsign,2,(colSums(Ptand5FUsign)),`/`)
colnames(Ptand5FUsign) <- c("SBS35","SBS17")
Ptand5FUsign<-cbind(Ptand5FUsign[,c("SBS35","SBS17")],rowSums(Ptand5FUsign[,c("SBS35","SBS17")])/2)
colnames(Ptand5FUsign) <- c("Platinum","5-FU","Platinum + 5-FU")
Ptand5FUsign <- sweep(Ptand5FUsign,2,(colSums(Ptand5FUsign)),`/`)
Ptand5FUsign
cosine_colon <- cos_sim_matrix(Ptand5FUsign,SBS_sign_colon)
plot_cosine_heatmap(cosine_colon,plot_values = T,cluster_rows = F,cluster_cols = F)
get_known_signatures(muttype = "dbs")
signatures_dbs = get_known_signatures(muttype = "dbs")
cosine_colon <- cos_sim_matrix(signatures_dbs,DBS_sign_colon)
plot_cosine_heatmap(cosine_colon,plot_values = T,cluster_rows = F,cluster_cols = F)
overview_data <- as.data.frame(read_xlsx("/Users/avanhoeck/hpc/cuppen/projects/P0002_5FU_Healthy/WGS_clones/analysis/Clinical_info/meta_data.xlsx",sheet = "Sheet1"))
overview_data_colon <- overview_data %>% dplyr::filter(Condition=="Healthy" & tissue =="Colon" & WGS_approach=="Organoid")%>% dplyr::pull(sample_name_R) %>% sort() %>% unique()
SBS_sign_contr_colon <- readRDS(signatures,file = "/Users/avanhoeck/hpc/cuppen/projects/P0002_5FU_Healthy/WGS_clones/analysis/Analysis/Data/Sign_analysis/Signatures/MutationPatterns/enovo_SBS_colon_sign_contribution.rds")
SBS_sign_contr_colon
DBS_sign_contr_colon <- readRDS(signatures,file = "/Users/avanhoeck/hpc/cuppen/projects/P0002_5FU_Healthy/WGS_clones/analysis/Analysis/Data/Sign_analysis/Signatures/MutationPatterns/enovo_DBS_colon_sign_contribution.rds")
SBS_sign_contr_liver <- readRDS(signatures,file = "/Users/avanhoeck/hpc/cuppen/projects/P0002_5FU_Healthy/WGS_clones/analysis/Analysis/Data/Sign_analysis/Signatures/MutationPatterns/enovo_SBS_liver_sign_contribution.rds")
DBS_sign_contr_liver <- readRDS(signatures,file = "/Users/avanhoeck/hpc/cuppen/projects/P0002_5FU_Healthy/WGS_clones/analysis/Analysis/Data/Sign_analysis/Signatures/MutationPatterns/enovo_DBS_liver_sign_contribution.rds")
DBS_sign_contr_colon
SBS_sign_contr_liver
colon_contr <- cbind(SBS_sign_contr_colon,DBS_sign_contr_colon)
liver_contr <- cbind(SBS_sign_contr_liver,DBS_sign_contr_liver)
SBS_sign_contr_colon
DBS_sign_contr_colon
SBS_sign_contr_colon
overview_data <- as.data.frame(read_xlsx("/Users/avanhoeck/hpc/cuppen/projects/P0002_5FU_Healthy/WGS_clones/analysis/Clinical_info/meta_data.xlsx",sheet = "Sheet1"))
overview_data_colon <- overview_data %>% dplyr::filter(Condition=="Healthy" & tissue =="Colon" & WGS_approach=="Organoid")%>% dplyr::pull(sample_name_R) %>% sort() %>% unique()
overview_data_colon
SBS_sign_contr_colon <- left_join(overview_data_colon,SBS_sign_contr_colon,by="sample_name_R")
SBS_sign_contr_colon <- readRDS(signatures,file = "/Users/avanhoeck/hpc/cuppen/projects/P0002_5FU_Healthy/WGS_clones/analysis/Analysis/Data/Sign_analysis/Signatures/MutationPatterns/enovo_SBS_colon_sign_contribution.rds")
overview_data <- as.data.frame(read_xlsx("/Users/avanhoeck/hpc/cuppen/projects/P0002_5FU_Healthy/WGS_clones/analysis/Clinical_info/meta_data.xlsx",sheet = "Sheet1"))
overview_data_colon <- overview_data %>% dplyr::filter(Condition=="Healthy" & tissue =="Colon" & WGS_approach=="Organoid")%>% dplyr::pull(sample_name_R) %>% sort() %>% unique()
SBS_sign_contr_colon <- SBS_sign_contr_colon %>% tibble::rownames_to_column("MutationType")
SBS_sign_contr_colon <- left_join(overview_data_colon,SBS_sign_contr_colon,by="sample_name_R")
overview_data_colon
overview_data %>% dplyr::filter(Condition=="Healthy" & tissue =="Colon" & WGS_approach=="Organoid")
overview_data_colon <- overview_data %>% dplyr::filter(Condition=="Healthy" & tissue =="Colon" & WGS_approach=="Organoid") %>% dplyr::select(sample_name_R,donor_id,pretreated)
SBS_sign_contr_colon <- SBS_sign_contr_colon %>% tibble::rownames_to_column("MutationType")
SBS_sign_contr_colon
SBS_sign_contr_colon <- SBS_sign_contr_colon %>% tibble::rownames_to_column("sample_name_R")
SBS_sign_contr_colon <- left_join(overview_data_colon,SBS_sign_contr_colon,by="sample_name_R")
DBS_sign_contr_colon <- DBS_sign_contr_colon %>% tibble::rownames_to_column("sample_name_R")
DBS_sign_contr_colon <- readRDS(signatures,file = "/Users/avanhoeck/hpc/cuppen/projects/P0002_5FU_Healthy/WGS_clones/analysis/Analysis/Data/Sign_analysis/Signatures/MutationPatterns/enovo_DBS_colon_sign_contribution.rds")
DBS_sign_contr_colon
DBS_sign_contr_colon <- DBS_sign_contr_colon %>% tibble::rownames_to_column("sample_name_R")
DBS_sign_contr_colon <- left_join(overview_data_colon,DBS_sign_contr_colon,by="sample_name_R")
DBS_sign_contr_colon
overview_data %>% dplyr::filter(Condition=="Healthy" & tissue =="Colon" & WGS_approach=="Organoid" & sample_name_R!=NA)
overview_data %>% dplyr::filter(Condition=="Healthy" & tissue =="Colon" & WGS_approach=="Organoid") %>%  dplyr::filter(!is.na(sample_name_R))
overview_data_colon <- overview_data %>% dplyr::filter(Condition=="Healthy" & tissue =="Colon" & WGS_approach=="Organoid") %>%  dplyr::filter(!is.na(sample_name_R)) %>%  dplyr::select(sample_name_R,donor_id,pretreated)
SBS_sign_contr_colon <- SBS_sign_contr_colon %>% tibble::rownames_to_column("sample_name_R")
SBS_sign_contr_colon <- left_join(overview_data_colon,SBS_sign_contr_colon,by="sample_name_R")
SBS_sign_contr_colon <- readRDS(signatures,file = "/Users/avanhoeck/hpc/cuppen/projects/P0002_5FU_Healthy/WGS_clones/analysis/Analysis/Data/Sign_analysis/Signatures/MutationPatterns/enovo_SBS_colon_sign_contribution.rds")
overview_data <- as.data.frame(read_xlsx("/Users/avanhoeck/hpc/cuppen/projects/P0002_5FU_Healthy/WGS_clones/analysis/Clinical_info/meta_data.xlsx",sheet = "Sheet1"))
overview_data_colon <- overview_data %>% dplyr::filter(Condition=="Healthy" & tissue =="Colon" & WGS_approach=="Organoid") %>%  dplyr::filter(!is.na(sample_name_R)) %>%  dplyr::select(sample_name_R,donor_id,pretreated)
SBS_sign_contr_colon <- SBS_sign_contr_colon %>% tibble::rownames_to_column("sample_name_R")
SBS_sign_contr_colon <- left_join(overview_data_colon,SBS_sign_contr_colon,by="sample_name_R")
DBS_sign_contr_colon <- readRDS(signatures,file = "/Users/avanhoeck/hpc/cuppen/projects/P0002_5FU_Healthy/WGS_clones/analysis/Analysis/Data/Sign_analysis/Signatures/MutationPatterns/enovo_DBS_colon_sign_contribution.rds")
DBS_sign_contr_colon <- DBS_sign_contr_colon %>% tibble::rownames_to_column("sample_name_R")
DBS_sign_contr_colon <- left_join(overview_data_colon,DBS_sign_contr_colon,by="sample_name_R")
DBS_sign_contr_colon <- readRDS(signatures,file = "/Users/avanhoeck/hpc/cuppen/projects/P0002_5FU_Healthy/WGS_clones/analysis/Analysis/Data/Sign_analysis/Signatures/MutationPatterns/enovo_DBS_colon_sign_contribution.rds")
DBS_sign_contr_colon <- DBS_sign_contr_colon %>% tibble::rownames_to_column("sample_name_R")
DBS_sign_contr_colon <- readRDS(signatures,file = "/Users/avanhoeck/hpc/cuppen/projects/P0002_5FU_Healthy/WGS_clones/analysis/Analysis/Data/Sign_analysis/Signatures/MutationPatterns/enovo_DBS_colon_sign_contribution.rds")
DBS_sign_contr_colon
DBS_sign_contr_colon <- DBS_sign_contr_colon %>% tibble::rownames_to_column("sample_name_R")
DBS_sign_contr_colon
DBS_sign_contr_colon <- readRDS(signatures,file = "/Users/avanhoeck/hpc/cuppen/projects/P0002_5FU_Healthy/WGS_clones/analysis/Analysis/Data/Sign_analysis/Signatures/MutationPatterns/enovo_DBS_colon_sign_contribution.rds")
SBS_sign_contr_colon <- readRDS(signatures,file = "/Users/avanhoeck/hpc/cuppen/projects/P0002_5FU_Healthy/WGS_clones/analysis/Analysis/Data/Sign_analysis/Signatures/MutationPatterns/enovo_SBS_colon_sign_contribution.rds")
DBS_sign_contr_colon <- readRDS(signatures,file = "/Users/avanhoeck/hpc/cuppen/projects/P0002_5FU_Healthy/WGS_clones/analysis/Analysis/Data/Sign_analysis/Signatures/MutationPatterns/enovo_DBS_colon_sign_contribution.rds")
SBS_sign_contr_liver <- readRDS(signatures,file = "/Users/avanhoeck/hpc/cuppen/projects/P0002_5FU_Healthy/WGS_clones/analysis/Analysis/Data/Sign_analysis/Signatures/MutationPatterns/enovo_SBS_liver_sign_contribution.rds")
DBS_sign_contr_liver <- readRDS(signatures,file = "/Users/avanhoeck/hpc/cuppen/projects/P0002_5FU_Healthy/WGS_clones/analysis/Analysis/Data/Sign_analysis/Signatures/MutationPatterns/enovo_DBS_liver_sign_contribution.rds")
overview_data <- as.data.frame(read_xlsx("/Users/avanhoeck/hpc/cuppen/projects/P0002_5FU_Healthy/WGS_clones/analysis/Clinical_info/meta_data.xlsx",sheet = "Sheet1"))
overview_data_colon <- overview_data %>% dplyr::filter(Condition=="Healthy" & tissue =="Colon" & WGS_approach=="Organoid") %>%  dplyr::filter(!is.na(sample_name_R)) %>%  dplyr::select(sample_name_R,donor_id,pretreated)
SBS_sign_contr_colon <- SBS_sign_contr_colon %>% tibble::rownames_to_column("sample_name_R")
SBS_sign_contr_colon <- left_join(overview_data_colon,SBS_sign_contr_colon,by="sample_name_R")
DBS_sign_contr_colon <- left_join(overview_data_colon,DBS_sign_contr_colon,by="sample_name_R")
DBS_sign_contr_colon
SBS_sign_contr_colon
wilcox.test(SBS_COL_A ~ pretreated, data = SBS_sign_contr_colon)$p.value
cbind(wilcox.test(SBS_COL_A ~ pretreated, data = SBS_sign_contr_colon)$p.value,eff.size.wilcox(data=SBS_sign_contr_colon,column1="SBS_COL_A",column2="pretreated"))
wilcox_SBS_COLON_A <- cbind(wilcox.test(SBS_COL_A ~ pretreated, data = SBS_sign_contr_colon)$p.value,eff.size.wilcox(data=SBS_sign_contr_colon,column1="SBS_COL_A",column2="pretreated"))
wilcox_SBS_COLON_B <- cbind(wilcox.test(SBS_COL_B ~ pretreated, data = SBS_sign_contr_colon)$p.value,eff.size.wilcox(data=SBS_sign_contr_colon,column1="SBS_COL_B",column2="pretreated"))
wilcox_SBS_COLON_C <- cbind(wilcox.test(SBS_COL_C ~ pretreated, data = SBS_sign_contr_colon)$p.value,eff.size.wilcox(data=SBS_sign_contr_colon,column1="SBS_COL_C",column2="pretreated"))
wilcox_SBS_COLON_D <- cbind(wilcox.test(SBS_COL_D ~ pretreated, data = SBS_sign_contr_colon)$p.value,eff.size.wilcox(data=SBS_sign_contr_colon,column1="SBS_COL_D",column2="pretreated"))
wilcox_SBS_COLON_E <- cbind(wilcox.test(SBS_COL_E ~ pretreated, data = SBS_sign_contr_colon)$p.value,eff.size.wilcox(data=SBS_sign_contr_colon,column1="SBS_COL_E",column2="pretreated"))
wilcox_SBS_COLON_F <- cbind(wilcox.test(SBS_COL_F ~ pretreated, data = SBS_sign_contr_colon)$p.value,eff.size.wilcox(data=SBS_sign_contr_colon,column1="SBS_COL_F",column2="pretreated"))
wilcox_SBS_COLON_G <- cbind(wilcox.test(SBS_COL_G ~ pretreated, data = SBS_sign_contr_colon)$p.value,eff.size.wilcox(data=SBS_sign_contr_colon,column1="SBS_COL_G",column2="pretreated"))
wilcox_SBS_COLON_H <- cbind(wilcox.test(SBS_COL_H ~ pretreated, data = SBS_sign_contr_colon)$p.value,eff.size.wilcox(data=SBS_sign_contr_colon,column1="SBS_COL_H",column2="pretreated"))
wilcox_SBS_COLON_I <- cbind(wilcox.test(SBS_COL_I ~ pretreated, data = SBS_sign_contr_colon)$p.value,eff.size.wilcox(data=SBS_sign_contr_colon,column1="SBS_COL_I",column2="pretreated"))
wilcox_SBS_COLON_J <- cbind(wilcox.test(SBS_COL_J ~ pretreated, data = SBS_sign_contr_colon)$p.value,eff.size.wilcox(data=SBS_sign_contr_colon,column1="SBS_COL_J",column2="pretreated"))
colon_SBS_stats <- rbind(wilcox_SBS_COL_A,wilcox_SBS_COL_B,wilcox_SBS_COL_C,wilcox_SBS_COL_D,wilcox_SBS_COL_E,wilcox_SBS_COL_F,wilcox_SBS_COL_G,wilcox_SBS_COL_H,wilcox_SBS_COL_I,wilcox_SBS_COL_J)
wilcox_SBS_COLON_A <- cbind(wilcox.test(SBS_COL_A ~ pretreated, data = SBS_sign_contr_colon)$p.value,eff.size.wilcox(data=SBS_sign_contr_colon,column1="SBS_COL_A",column2="pretreated"))
wilcox_SBS_COLON_B <- cbind(wilcox.test(SBS_COL_B ~ pretreated, data = SBS_sign_contr_colon)$p.value,eff.size.wilcox(data=SBS_sign_contr_colon,column1="SBS_COL_B",column2="pretreated"))
wilcox_SBS_COLON_C <- cbind(wilcox.test(SBS_COL_C ~ pretreated, data = SBS_sign_contr_colon)$p.value,eff.size.wilcox(data=SBS_sign_contr_colon,column1="SBS_COL_C",column2="pretreated"))
wilcox_SBS_COLON_D <- cbind(wilcox.test(SBS_COL_D ~ pretreated, data = SBS_sign_contr_colon)$p.value,eff.size.wilcox(data=SBS_sign_contr_colon,column1="SBS_COL_D",column2="pretreated"))
wilcox_SBS_COLON_E <- cbind(wilcox.test(SBS_COL_E ~ pretreated, data = SBS_sign_contr_colon)$p.value,eff.size.wilcox(data=SBS_sign_contr_colon,column1="SBS_COL_E",column2="pretreated"))
wilcox_SBS_COLON_F <- cbind(wilcox.test(SBS_COL_F ~ pretreated, data = SBS_sign_contr_colon)$p.value,eff.size.wilcox(data=SBS_sign_contr_colon,column1="SBS_COL_F",column2="pretreated"))
wilcox_SBS_COLON_G <- cbind(wilcox.test(SBS_COL_G ~ pretreated, data = SBS_sign_contr_colon)$p.value,eff.size.wilcox(data=SBS_sign_contr_colon,column1="SBS_COL_G",column2="pretreated"))
wilcox_SBS_COLON_H <- cbind(wilcox.test(SBS_COL_H ~ pretreated, data = SBS_sign_contr_colon)$p.value,eff.size.wilcox(data=SBS_sign_contr_colon,column1="SBS_COL_H",column2="pretreated"))
wilcox_SBS_COLON_I <- cbind(wilcox.test(SBS_COL_I ~ pretreated, data = SBS_sign_contr_colon)$p.value,eff.size.wilcox(data=SBS_sign_contr_colon,column1="SBS_COL_I",column2="pretreated"))
wilcox_SBS_COLON_J <- cbind(wilcox.test(SBS_COL_J ~ pretreated, data = SBS_sign_contr_colon)$p.value,eff.size.wilcox(data=SBS_sign_contr_colon,column1="SBS_COL_J",column2="pretreated"))
stats <- rbind(wilcox_SBS_COLON_A,wilcox_SBS_COLON_B,wilcox_SBS_COLON_C,wilcox_SBS_COLON_D,wilcox_SBS_COLON_E,wilcox_SBS_COLON_F,wilcox_SBS_COLON_G,wilcox_SBS_COLON_H,wilcox_SBS_COLON_I,wilcox_SBS_COLON_J)
overview_data <- as.data.frame(read_xlsx("/Users/avanhoeck/hpc/cuppen/projects/P0002_5FU_Healthy/WGS_clones/analysis/Clinical_info/meta_data.xlsx",sheet = "Sheet1"))
overview_data_colon <- overview_data %>% dplyr::filter(Condition=="Healthy" & tissue =="Colon" & WGS_approach=="Organoid") %>%  dplyr::filter(!is.na(sample_name_R)) %>%  dplyr::select(sample_name_R,donor_id,pretreated)
DBS_sign_contr_colon
wilcox_DBS_COLON_A <- cbind(wilcox.test(DBS_COL_A ~ pretreated, data = DBS_sign_contr_colon)$p.value,eff.size.wilcox(data=DBS_sign_contr_colon,column1="DBS_COL_A",column2="pretreated"))
wilcox.test(DBS_COL_A ~ pretreated, data = DBS_sign_contr_colon)$p.value
eff.size.wilcox(data=DBS_sign_contr_colon,column1="DBS_COL_A",column2="pretreated")
wilcox_DBS_COLON_A <- cbind(wilcox.test(DBS_COL_A ~ pretreated, data = DBS_sign_contr_colon)$p.value,eff.size.wilcox(data=DBS_sign_contr_colon,column1="DBS_COL_A",column2="pretreated"))
wilcox_DBS_COLON_B <- cbind(wilcox.test(DBS_COL_B ~ pretreated, data = DBS_sign_contr_colon)$p.value,eff.size.wilcox(data=DBS_sign_contr_colon,column1="DBS_COL_B",column2="pretreated"))
wilcox_DBS_COLON_C <- cbind(wilcox.test(DBS_COL_C ~ pretreated, data = DBS_sign_contr_colon)$p.value,eff.size.wilcox(data=DBS_sign_contr_colon,column1="DBS_COL_C",column2="pretreated"))
wilcox_DBS_COLON_D <- cbind(wilcox.test(DBS_COL_D ~ pretreated, data = DBS_sign_contr_colon)$p.value,eff.size.wilcox(data=DBS_sign_contr_colon,column1="DBS_COL_D",column2="pretreated"))
wilcox_DBS_COLON_E <- cbind(wilcox.test(DBS_COL_E ~ pretreated, data = DBS_sign_contr_colon)$p.value,eff.size.wilcox(data=DBS_sign_contr_colon,column1="DBS_COL_E",column2="pretreated"))
wilcox_DBS_COLON_F <- cbind(wilcox.test(DBS_COL_F ~ pretreated, data = DBS_sign_contr_colon)$p.value,eff.size.wilcox(data=DBS_sign_contr_colon,column1="DBS_COL_F",column2="pretreated"))
colon_DBS_contribution_stats <- rbind(wilcox_DBS_COLON_A,wilcox_DBS_COLON_B,wilcox_DBS_COLON_C,wilcox_DBS_COLON_D,wilcox_DBS_COLON_E,wilcox_DBS_COLON_F)
colon_DBS_contribution_stats
colnames(colon_SBS_contribution_stats) <- c("P-value","Effect_size")
colon_SBS_contribution_stats
colon_SBS_contribution_stats <- rbind(wilcox_SBS_COLON_A,wilcox_SBS_COLON_B,wilcox_SBS_COLON_C,wilcox_SBS_COLON_D,wilcox_SBS_COLON_E,wilcox_SBS_COLON_F,wilcox_SBS_COLON_G,wilcox_SBS_COLON_H,wilcox_SBS_COLON_I,wilcox_SBS_COLON_J)
colnames(colon_SBS_contribution_stats) <- c("P-value","Effect_size")
rownames(colon_SBS_contribution_stats)
SBS_sign_contr_colon
overview_data <- as.data.frame(read_xlsx("/Users/avanhoeck/hpc/cuppen/projects/P0002_5FU_Healthy/WGS_clones/analysis/Clinical_info/meta_data.xlsx",sheet = "Sheet1"))
overview_data_liver <- overview_data %>% dplyr::filter(Condition=="Healthy" & tissue =="Liver" & WGS_approach=="Organoid") %>%  dplyr::filter(!is.na(sample_name_R)) %>%  dplyr::select(sample_name_R,donor_id,pretreated)
SBS_sign_contr_liver <- SBS_sign_contr_liver %>% tibble::rownames_to_LIVumn("sample_name_R")
SBS_sign_contr_liver <- readRDS(signatures,file = "/Users/avanhoeck/hpc/cuppen/projects/P0002_5FU_Healthy/WGS_clones/analysis/Analysis/Data/Sign_analysis/Signatures/MutationPatterns/enovo_SBS_liver_sign_contribution.rds")
SBS_sign_contr_liver
wilcox_SBS_liver_A <- cbind(wilcox.test(SBS_LIV_A ~ pretreated, data = SBS_sign_contr_liver)$p.value,eff.size.wilcox(data=SBS_sign_contr_liver,column1="SBS_LIV_A",column2="pretreated"))
wilcox_SBS_liver_B <- cbind(wilcox.test(SBS_LIV_B ~ pretreated, data = SBS_sign_contr_liver)$p.value,eff.size.wilcox(data=SBS_sign_contr_liver,column1="SBS_LIV_B",column2="pretreated"))
wilcox_SBS_liver_C <- cbind(wilcox.test(SBS_LIV_C ~ pretreated, data = SBS_sign_contr_liver)$p.value,eff.size.wilcox(data=SBS_sign_contr_liver,column1="SBS_LIV_C",column2="pretreated"))
SBS_sign_contr_liver <- left_join(overview_data_liver,SBS_sign_contr_liver,by="sample_name_R")
wilcox_SBS_liver_A <- cbind(wilcox.test(SBS_LIV_A ~ pretreated, data = SBS_sign_contr_liver)$p.value,eff.size.wilcox(data=SBS_sign_contr_liver,column1="SBS_LIV_A",column2="pretreated"))
wilcox_SBS_liver_B <- cbind(wilcox.test(SBS_LIV_B ~ pretreated, data = SBS_sign_contr_liver)$p.value,eff.size.wilcox(data=SBS_sign_contr_liver,column1="SBS_LIV_B",column2="pretreated"))
wilcox_SBS_liver_C <- cbind(wilcox.test(SBS_LIV_C ~ pretreated, data = SBS_sign_contr_liver)$p.value,eff.size.wilcox(data=SBS_sign_contr_liver,column1="SBS_LIV_C",column2="pretreated"))
wilcox_SBS_liver_D <- cbind(wilcox.test(SBS_LIV_D ~ pretreated, data = SBS_sign_contr_liver)$p.value,eff.size.wilcox(data=SBS_sign_contr_liver,column1="SBS_LIV_D",column2="pretreated"))
wilcox_SBS_liver_E <- cbind(wilcox.test(SBS_LIV_E ~ pretreated, data = SBS_sign_contr_liver)$p.value,eff.size.wilcox(data=SBS_sign_contr_liver,column1="SBS_LIV_E",column2="pretreated"))
wilcox_SBS_liver_F <- cbind(wilcox.test(SBS_LIV_F ~ pretreated, data = SBS_sign_contr_liver)$p.value,eff.size.wilcox(data=SBS_sign_contr_liver,column1="SBS_LIV_F",column2="pretreated"))
wilcox_SBS_liver_G <- cbind(wilcox.test(SBS_LIV_G ~ pretreated, data = SBS_sign_contr_liver)$p.value,eff.size.wilcox(data=SBS_sign_contr_liver,column1="SBS_LIV_G",column2="pretreated"))
wilcox_SBS_liver_H <- cbind(wilcox.test(SBS_LIV_H ~ pretreated, data = SBS_sign_contr_liver)$p.value,eff.size.wilcox(data=SBS_sign_contr_liver,column1="SBS_LIV_H",column2="pretreated"))
wilcox_SBS_liver_I <- cbind(wilcox.test(SBS_LIV_I ~ pretreated, data = SBS_sign_contr_liver)$p.value,eff.size.wilcox(data=SBS_sign_contr_liver,column1="SBS_LIV_I",column2="pretreated"))
wilcox_SBS_liver_J <- cbind(wilcox.test(SBS_LIV_J ~ pretreated, data = SBS_sign_contr_liver)$p.value,eff.size.wilcox(data=SBS_sign_contr_liver,column1="SBS_LIV_J",column2="pretreated"))
wilcox_SBS_liver_A <- cbind(wilcox.test(SBS_LIV_A ~ pretreated, data = SBS_sign_contr_liver)$p.value,eff.size.wilcox(data=SBS_sign_contr_liver,column1="SBS_LIV_A",column2="pretreated"))
wilcox_SBS_liver_B <- cbind(wilcox.test(SBS_LIV_B ~ pretreated, data = SBS_sign_contr_liver)$p.value,eff.size.wilcox(data=SBS_sign_contr_liver,column1="SBS_LIV_B",column2="pretreated"))
wilcox_SBS_liver_C <- cbind(wilcox.test(SBS_LIV_C ~ pretreated, data = SBS_sign_contr_liver)$p.value,eff.size.wilcox(data=SBS_sign_contr_liver,column1="SBS_LIV_C",column2="pretreated"))
wilcox_SBS_liver_D <- cbind(wilcox.test(SBS_LIV_D ~ pretreated, data = SBS_sign_contr_liver)$p.value,eff.size.wilcox(data=SBS_sign_contr_liver,column1="SBS_LIV_D",column2="pretreated"))
wilcox_SBS_liver_E <- cbind(wilcox.test(SBS_LIV_E ~ pretreated, data = SBS_sign_contr_liver)$p.value,eff.size.wilcox(data=SBS_sign_contr_liver,column1="SBS_LIV_E",column2="pretreated"))
wilcox_SBS_liver_F <- cbind(wilcox.test(SBS_LIV_F ~ pretreated, data = SBS_sign_contr_liver)$p.value,eff.size.wilcox(data=SBS_sign_contr_liver,column1="SBS_LIV_F",column2="pretreated"))
wilcox_SBS_liver_G <- cbind(wilcox.test(SBS_LIV_G ~ pretreated, data = SBS_sign_contr_liver)$p.value,eff.size.wilcox(data=SBS_sign_contr_liver,column1="SBS_LIV_G",column2="pretreated"))
wilcox_SBS_liver_H <- cbind(wilcox.test(SBS_LIV_H ~ pretreated, data = SBS_sign_contr_liver)$p.value,eff.size.wilcox(data=SBS_sign_contr_liver,column1="SBS_LIV_H",column2="pretreated"))
wilcox_SBS_liver_I <- cbind(wilcox.test(SBS_LIV_I ~ pretreated, data = SBS_sign_contr_liver)$p.value,eff.size.wilcox(data=SBS_sign_contr_liver,column1="SBS_LIV_I",column2="pretreated"))
wilcox_SBS_liver_J <- cbind(wilcox.test(SBS_LIV_J ~ pretreated, data = SBS_sign_contr_liver)$p.value,eff.size.wilcox(data=SBS_sign_contr_liver,column1="SBS_LIV_J",column2="pretreated"))
wilcox_SBS_liver_K <- cbind(wilcox.test(SBS_LIV_K ~ pretreated, data = SBS_sign_contr_liver)$p.value,eff.size.wilcox(data=SBS_sign_contr_liver,column1="SBS_LIV_K",column2="pretreated"))
wilcox_SBS_liver_L <- cbind(wilcox.test(SBS_LIV_L ~ pretreated, data = SBS_sign_contr_liver)$p.value,eff.size.wilcox(data=SBS_sign_contr_liver,column1="SBS_LIV_L",column2="pretreated"))
wilcox_SBS_liver_M <- cbind(wilcox.test(SBS_LIV_M ~ pretreated, data = SBS_sign_contr_liver)$p.value,eff.size.wilcox(data=SBS_sign_contr_liver,column1="SBS_LIV_M",column2="pretreated"))
liver_SBS_contribution_stats <- rbind(wilcox_SBS_liver_A,wilcox_SBS_liver_B,wilcox_SBS_liver_C,wilcox_SBS_liver_D,wilcox_SBS_liver_E,wilcox_SBS_liver_F,wilcox_SBS_liver_G,wilcox_SBS_liver_H,wilcox_SBS_liver_I,wilcox_SBS_liver_J,wilcox_SBS_liver_K,wilcox_SBS_liver_L,wilcox_SBS_liver_M)
colnames(colon_SBS_contribution_stats) <- c("P-value","Effect_size")
rownames(colon_SBS_contribution_stats) <-c("SBS_LIV_A", "SBS_LIV_B","SBS_LIV_C", "SBS_LIV_D","SBS_LIV_E", "SBS_LIV_F","SBS_LIV_G", "SBS_LIV_H","SBS_LIV_I", "SBS_LIV_J", "SBS_LIV_K","SBS_LIV_L", "SBS_LIV_M")
wilcox_SBS_liver_A <- cbind(wilcox.test(SBS_LIV_A ~ pretreated, data = SBS_sign_contr_liver)$p.value,eff.size.wilcox(data=SBS_sign_contr_liver,column1="SBS_LIV_A",column2="pretreated"))
wilcox_SBS_liver_B <- cbind(wilcox.test(SBS_LIV_B ~ pretreated, data = SBS_sign_contr_liver)$p.value,eff.size.wilcox(data=SBS_sign_contr_liver,column1="SBS_LIV_B",column2="pretreated"))
wilcox_SBS_liver_C <- cbind(wilcox.test(SBS_LIV_C ~ pretreated, data = SBS_sign_contr_liver)$p.value,eff.size.wilcox(data=SBS_sign_contr_liver,column1="SBS_LIV_C",column2="pretreated"))
wilcox_SBS_liver_D <- cbind(wilcox.test(SBS_LIV_D ~ pretreated, data = SBS_sign_contr_liver)$p.value,eff.size.wilcox(data=SBS_sign_contr_liver,column1="SBS_LIV_D",column2="pretreated"))
wilcox_SBS_liver_E <- cbind(wilcox.test(SBS_LIV_E ~ pretreated, data = SBS_sign_contr_liver)$p.value,eff.size.wilcox(data=SBS_sign_contr_liver,column1="SBS_LIV_E",column2="pretreated"))
wilcox_SBS_liver_F <- cbind(wilcox.test(SBS_LIV_F ~ pretreated, data = SBS_sign_contr_liver)$p.value,eff.size.wilcox(data=SBS_sign_contr_liver,column1="SBS_LIV_F",column2="pretreated"))
wilcox_SBS_liver_G <- cbind(wilcox.test(SBS_LIV_G ~ pretreated, data = SBS_sign_contr_liver)$p.value,eff.size.wilcox(data=SBS_sign_contr_liver,column1="SBS_LIV_G",column2="pretreated"))
wilcox_SBS_liver_H <- cbind(wilcox.test(SBS_LIV_H ~ pretreated, data = SBS_sign_contr_liver)$p.value,eff.size.wilcox(data=SBS_sign_contr_liver,column1="SBS_LIV_H",column2="pretreated"))
wilcox_SBS_liver_I <- cbind(wilcox.test(SBS_LIV_I ~ pretreated, data = SBS_sign_contr_liver)$p.value,eff.size.wilcox(data=SBS_sign_contr_liver,column1="SBS_LIV_I",column2="pretreated"))
wilcox_SBS_liver_J <- cbind(wilcox.test(SBS_LIV_J ~ pretreated, data = SBS_sign_contr_liver)$p.value,eff.size.wilcox(data=SBS_sign_contr_liver,column1="SBS_LIV_J",column2="pretreated"))
wilcox_SBS_liver_K <- cbind(wilcox.test(SBS_LIV_K ~ pretreated, data = SBS_sign_contr_liver)$p.value,eff.size.wilcox(data=SBS_sign_contr_liver,column1="SBS_LIV_K",column2="pretreated"))
wilcox_SBS_liver_L <- cbind(wilcox.test(SBS_LIV_L ~ pretreated, data = SBS_sign_contr_liver)$p.value,eff.size.wilcox(data=SBS_sign_contr_liver,column1="SBS_LIV_L",column2="pretreated"))
wilcox_SBS_liver_M <- cbind(wilcox.test(SBS_LIV_M ~ pretreated, data = SBS_sign_contr_liver)$p.value,eff.size.wilcox(data=SBS_sign_contr_liver,column1="SBS_LIV_M",column2="pretreated"))
liver_SBS_contribution_stats <- rbind(wilcox_SBS_liver_A,wilcox_SBS_liver_B,wilcox_SBS_liver_C,wilcox_SBS_liver_D,wilcox_SBS_liver_E,wilcox_SBS_liver_F,wilcox_SBS_liver_G,wilcox_SBS_liver_H,wilcox_SBS_liver_I,wilcox_SBS_liver_J,wilcox_SBS_liver_K,wilcox_SBS_liver_L,wilcox_SBS_liver_M)
liver_SBS_contribution_stats
rownames(colon_SBS_contribution_stats) <-c("SBS_LIV_A", "SBS_LIV_B","SBS_LIV_C", "SBS_LIV_D","SBS_LIV_E", "SBS_LIV_F","SBS_LIV_G", "SBS_LIV_H","SBS_LIV_I", "SBS_LIV_J", "SBS_LIV_K","SBS_LIV_L", "SBS_LIV_M")
liver_SBS_contribution_stats <- rbind(wilcox_SBS_liver_A,wilcox_SBS_liver_B,wilcox_SBS_liver_C,wilcox_SBS_liver_D,wilcox_SBS_liver_E,wilcox_SBS_liver_F,wilcox_SBS_liver_G,wilcox_SBS_liver_H,wilcox_SBS_liver_I,wilcox_SBS_liver_J,wilcox_SBS_liver_K,wilcox_SBS_liver_L,wilcox_SBS_liver_M)
colnames(liver_SBS_contribution_stats) <- c("P-value","Effect_size")
rownames(liver_SBS_contribution_stats) <-c("SBS_LIV_A", "SBS_LIV_B","SBS_LIV_C", "SBS_LIV_D","SBS_LIV_E", "SBS_LIV_F","SBS_LIV_G", "SBS_LIV_H","SBS_LIV_I", "SBS_LIV_J", "SBS_LIV_K","SBS_LIV_L", "SBS_LIV_M")
DBS_sign_contr_liver
liver_DBS_contribution_stats <- rbind(wilcox_DBS_liver_A,wilcox_DBS_liver_B,wilcox_DBS_liver_C,wilcox_DBS_liver_D,wilcox_DBS_liver_E,wilcox_DBS_liver_F)
colnames(liver_DBS_contribution_stats) <- c("P-value","Effect_size")
wilcox_DBS_liver_A <- cbind(wilcox.test(DBS_LIV_A ~ pretreated, data = DBS_sign_contr_liver)$p.value,eff.size.wilcox(data=DBS_sign_contr_liver,column1="DBS_LIV_A",column2="pretreated"))
wilcox_DBS_liver_B <- cbind(wilcox.test(DBS_LIV_B ~ pretreated, data = DBS_sign_contr_liver)$p.value,eff.size.wilcox(data=DBS_sign_contr_liver,column1="DBS_LIV_B",column2="pretreated"))
wilcox_DBS_liver_C <- cbind(wilcox.test(DBS_LIV_C ~ pretreated, data = DBS_sign_contr_liver)$p.value,eff.size.wilcox(data=DBS_sign_contr_liver,column1="DBS_LIV_C",column2="pretreated"))
wilcox_DBS_liver_D <- cbind(wilcox.test(DBS_LIV_D ~ pretreated, data = DBS_sign_contr_liver)$p.value,eff.size.wilcox(data=DBS_sign_contr_liver,column1="DBS_LIV_D",column2="pretreated"))
wilcox_DBS_liver_E <- cbind(wilcox.test(DBS_LIV_E ~ pretreated, data = DBS_sign_contr_liver)$p.value,eff.size.wilcox(data=DBS_sign_contr_liver,column1="DBS_LIV_E",column2="pretreated"))
wilcox_DBS_liver_F <- cbind(wilcox.test(DBS_LIV_F ~ pretreated, data = DBS_sign_contr_liver)$p.value,eff.size.wilcox(data=DBS_sign_contr_liver,column1="DBS_LIV_F",column2="pretreated"))
liver_DBS_contribution_stats <- rbind(wilcox_DBS_liver_A,wilcox_DBS_liver_B,wilcox_DBS_liver_C,wilcox_DBS_liver_D,wilcox_DBS_liver_E,wilcox_DBS_liver_F)
colnames(liver_DBS_contribution_stats) <- c("P-value","Effect_size")
DBS_sign_contr_liver
DBS_sign_contr_liver <- left_join(overview_data_liver,DBS_sign_contr_liver,by="sample_name_R")
DBS_sign_contr_liver
DBS_sign_contr_liver <- readRDS(signatures,file = "/Users/avanhoeck/hpc/cuppen/projects/P0002_5FU_Healthy/WGS_clones/analysis/Analysis/Data/Sign_analysis/Signatures/MutationPatterns/enovo_DBS_liver_sign_contribution.rds")
DBS_sign_contr_liver
overview_data <- as.data.frame(read_xlsx("/Users/avanhoeck/hpc/cuppen/projects/P0002_5FU_Healthy/WGS_clones/analysis/Clinical_info/meta_data.xlsx",sheet = "Sheet1"))
overview_data_liver <- overview_data %>% dplyr::filter(Condition=="Healthy" & tissue =="Liver" & WGS_approach=="Organoid") %>%  dplyr::filter(!is.na(sample_name_R)) %>%  dplyr::select(sample_name_R,donor_id,pretreated)
left_join(overview_data_liver,SBS_sign_contr_liver,by="sample_name_R")
left_join(overview_data_liver,DBS_sign_contr_liver,by="sample_name_R")
DBS_sign_contr_liver
overview_data_liver
DBS_sign_contr_liver
overview_data_liver
DBS_sign_contr_liver
###DBS LIVER
mut_mat_sub <- readRDS(file = "/Users/avanhoeck/hpc/cuppen/projects/P0002_5FU_Healthy/WGS_clones/analysis/Analysis/Data/Sign_analysis/mutationMatrices/DBS_liver.rds")
head(mut_mat_sub)
mut_mat_liver_1 <- mut_mat_sub + 0.0001
mut_mat_liver_1 <- mut_mat_sub + 0.0001
nmf_res <- extract_signatures(as.matrix(mut_mat_colon_1),rank=6,nrun=10)
colnames(nmf_res$signatures) <- c("DBS_LIV_A", "DBS_LIV_B","DBS_LIV_C", "DBS_LIV_D","DBS_LIV_E", "DBS_LIV_F")
rownames(nmf_res$contribution) <- c("DBS_LIV_A", "DBS_LIV_B","DBS_LIV_C", "DBS_LIV_D","DBS_LIV_E", "DBS_LIV_F")
signatures <- as.data.frame(nmf_res$signatures)
signatures <- sweep(signatures,2,(colSums(signatures)),`/`)
plot_dbs_contexts(signatures, condensed = TRUE)
total_signatures <- colSums(nmf_res$signatures)
abs_contribution <- nmf_res$contribution * total_signatures
abs_contribution <- as.data.frame(t(abs_contribution))
saveRDS(signatures,file = "/Users/avanhoeck/hpc/cuppen/projects/P0002_5FU_Healthy/WGS_clones/analysis/Analysis/Data/Sign_analysis/Signatures/MutationPatterns/denovo_DBS_liver_sign.rds")
signatures <- signatures %>% tibble::rownames_to_column("MutationType")
write.table(signatures, file = "/Users/avanhoeck/hpc/cuppen/projects/P0002_5FU_Healthy/WGS_clones/analysis/Analysis/Data/Sign_analysis/Signatures/MutationPatterns/denovo_DBS_liver_sign.txt",sep = "\t", col.names = NA,qmethod = "double", quote = FALSE)
abs_contribution <- tibble::rownames_to_column(abs_contribution, "sample_name_R")
saveRDS(abs_contribution,file = "/Users/avanhoeck/hpc/cuppen/projects/P0002_5FU_Healthy/WGS_clones/analysis/Analysis/Data/Sign_analysis/Signatures/MutationPatterns/enovo_DBS_liver_sign_contribution.rds")
write.table(abs_contribution, file = "/Users/avanhoeck/hpc/cuppen/projects/P0002_5FU_Healthy/WGS_clones/analysis/Analysis/Data/Sign_analysis/Signatures/MutationPatterns/denovo_DBS_liver_sign_contribution.txt",sep = "\t", col.names = NA,qmethod = "double", quote = FALSE)
abs_contribution
nmf_res
mut_mat_sub
nmf_res <- extract_signatures(as.matrix(mut_mat_liver_1),rank=6,nrun=10)
###DBS LIVER
mut_mat_sub <- readRDS(file = "/Users/avanhoeck/hpc/cuppen/projects/P0002_5FU_Healthy/WGS_clones/analysis/Analysis/Data/Sign_analysis/mutationMatrices/DBS_liver.rds")
head(mut_mat_sub)
mut_mat_liver_1 <- mut_mat_sub + 0.0001
nmf_res <- extract_signatures(as.matrix(mut_mat_liver_1),rank=6,nrun=10)
colnames(nmf_res$signatures) <- c("DBS_LIV_A", "DBS_LIV_B","DBS_LIV_C", "DBS_LIV_D","DBS_LIV_E", "DBS_LIV_F")
rownames(nmf_res$contribution) <- c("DBS_LIV_A", "DBS_LIV_B","DBS_LIV_C", "DBS_LIV_D","DBS_LIV_E", "DBS_LIV_F")
signatures <- as.data.frame(nmf_res$signatures)
signatures <- sweep(signatures,2,(colSums(signatures)),`/`)
plot_dbs_contexts(signatures, condensed = TRUE)
total_signatures <- colSums(nmf_res$signatures)
abs_contribution <- nmf_res$contribution * total_signatures
abs_contribution <- as.data.frame(t(abs_contribution))
saveRDS(signatures,file = "/Users/avanhoeck/hpc/cuppen/projects/P0002_5FU_Healthy/WGS_clones/analysis/Analysis/Data/Sign_analysis/Signatures/MutationPatterns/denovo_DBS_liver_sign.rds")
signatures <- signatures %>% tibble::rownames_to_column("MutationType")
write.table(signatures, file = "/Users/avanhoeck/hpc/cuppen/projects/P0002_5FU_Healthy/WGS_clones/analysis/Analysis/Data/Sign_analysis/Signatures/MutationPatterns/denovo_DBS_liver_sign.txt",sep = "\t", col.names = NA,qmethod = "double", quote = FALSE)
abs_contribution <- tibble::rownames_to_column(abs_contribution, "sample_name_R")
saveRDS(abs_contribution,file = "/Users/avanhoeck/hpc/cuppen/projects/P0002_5FU_Healthy/WGS_clones/analysis/Analysis/Data/Sign_analysis/Signatures/MutationPatterns/enovo_DBS_liver_sign_contribution.rds")
write.table(abs_contribution, file = "/Users/avanhoeck/hpc/cuppen/projects/P0002_5FU_Healthy/WGS_clones/analysis/Analysis/Data/Sign_analysis/Signatures/MutationPatterns/denovo_DBS_liver_sign_contribution.txt",sep = "\t", col.names = NA,qmethod = "double", quote = FALSE)
DBS_sign_liver <- readRDS(signatures,file = "/Users/avanhoeck/hpc/cuppen/projects/P0002_5FU_Healthy/WGS_clones/analysis/Analysis/Data/Sign_analysis/Signatures/MutationPatterns/denovo_DBS_liver_sign.rds")
DBS_sign_contr_liver <- readRDS(signatures,file = "/Users/avanhoeck/hpc/cuppen/projects/P0002_5FU_Healthy/WGS_clones/analysis/Analysis/Data/Sign_analysis/Signatures/MutationPatterns/enovo_DBS_liver_sign_contribution.rds")
DBS_sign_contr_liver
overview_data_liver <- overview_data %>% dplyr::filter(Condition=="Healthy" & tissue =="Liver" & WGS_approach=="Organoid") %>%  dplyr::filter(!is.na(sample_name_R)) %>%  dplyr::select(sample_name_R,donor_id,pretreated)
DBS_sign_contr_liver <- left_join(overview_data_liver,DBS_sign_contr_liver,by="sample_name_R")
wilcox_DBS_liver_A <- cbind(wilcox.test(DBS_LIV_A ~ pretreated, data = DBS_sign_contr_liver)$p.value,eff.size.wilcox(data=DBS_sign_contr_liver,column1="DBS_LIV_A",column2="pretreated"))
wilcox_DBS_liver_B <- cbind(wilcox.test(DBS_LIV_B ~ pretreated, data = DBS_sign_contr_liver)$p.value,eff.size.wilcox(data=DBS_sign_contr_liver,column1="DBS_LIV_B",column2="pretreated"))
wilcox_DBS_liver_C <- cbind(wilcox.test(DBS_LIV_C ~ pretreated, data = DBS_sign_contr_liver)$p.value,eff.size.wilcox(data=DBS_sign_contr_liver,column1="DBS_LIV_C",column2="pretreated"))
wilcox_DBS_liver_D <- cbind(wilcox.test(DBS_LIV_D ~ pretreated, data = DBS_sign_contr_liver)$p.value,eff.size.wilcox(data=DBS_sign_contr_liver,column1="DBS_LIV_D",column2="pretreated"))
wilcox_DBS_liver_E <- cbind(wilcox.test(DBS_LIV_E ~ pretreated, data = DBS_sign_contr_liver)$p.value,eff.size.wilcox(data=DBS_sign_contr_liver,column1="DBS_LIV_E",column2="pretreated"))
wilcox_DBS_liver_F <- cbind(wilcox.test(DBS_LIV_F ~ pretreated, data = DBS_sign_contr_liver)$p.value,eff.size.wilcox(data=DBS_sign_contr_liver,column1="DBS_LIV_F",column2="pretreated"))
liver_DBS_contribution_stats <- rbind(wilcox_DBS_liver_A,wilcox_DBS_liver_B,wilcox_DBS_liver_C,wilcox_DBS_liver_D,wilcox_DBS_liver_E,wilcox_DBS_liver_F)
colnames(liver_DBS_contribution_stats) <- c("P-value","Effect_size")
rownames(liver_DBS_contribution_stats) <-c("DBS_LIV_A", "DBS_LIV_B","DBS_LIV_C", "DBS_LIV_D","DBS_LIV_E", "DBS_LIV_F")
liver_DBS_contribution_stats
liver_DBS_contribution_stats
rbind(colon_SBS_contribution_stats,colon_DBS_contribution_stats)
colon_SBS_contribution_stats
colon_DBS_contribution_stats
liver_DBS_contribution_stats
colon_SBS_contribution_stats
overview_data <- as.data.frame(read_xlsx("/Users/avanhoeck/hpc/cuppen/projects/P0002_5FU_Healthy/WGS_clones/analysis/Clinical_info/meta_data.xlsx",sheet = "Sheet1"))
overview_data_colon <- overview_data %>% dplyr::filter(Condition=="Healthy" & tissue =="Colon" & WGS_approach=="Organoid") %>%  dplyr::filter(!is.na(sample_name_R)) %>%  dplyr::select(sample_name_R,donor_id,pretreated)
SBS_sign_contr_colon <- SBS_sign_contr_colon %>% tibble::rownames_to_column("sample_name_R")
SBS_sign_contr_colon <- left_join(overview_data_colon,SBS_sign_contr_colon,by="sample_name_R")
DBS_sign_contr_colon <- left_join(overview_data_colon,DBS_sign_contr_colon,by="sample_name_R")
wilcox_SBS_COLON_A <- cbind(wilcox.test(SBS_COL_A ~ pretreated, data = SBS_sign_contr_colon)$p.value,eff.size.wilcox(data=SBS_sign_contr_colon,column1="SBS_COL_A",column2="pretreated"))
wilcox_SBS_COLON_B <- cbind(wilcox.test(SBS_COL_B ~ pretreated, data = SBS_sign_contr_colon)$p.value,eff.size.wilcox(data=SBS_sign_contr_colon,column1="SBS_COL_B",column2="pretreated"))
wilcox_SBS_COLON_C <- cbind(wilcox.test(SBS_COL_C ~ pretreated, data = SBS_sign_contr_colon)$p.value,eff.size.wilcox(data=SBS_sign_contr_colon,column1="SBS_COL_C",column2="pretreated"))
wilcox_SBS_COLON_D <- cbind(wilcox.test(SBS_COL_D ~ pretreated, data = SBS_sign_contr_colon)$p.value,eff.size.wilcox(data=SBS_sign_contr_colon,column1="SBS_COL_D",column2="pretreated"))
wilcox_SBS_COLON_E <- cbind(wilcox.test(SBS_COL_E ~ pretreated, data = SBS_sign_contr_colon)$p.value,eff.size.wilcox(data=SBS_sign_contr_colon,column1="SBS_COL_E",column2="pretreated"))
wilcox_SBS_COLON_F <- cbind(wilcox.test(SBS_COL_F ~ pretreated, data = SBS_sign_contr_colon)$p.value,eff.size.wilcox(data=SBS_sign_contr_colon,column1="SBS_COL_F",column2="pretreated"))
wilcox_SBS_COLON_G <- cbind(wilcox.test(SBS_COL_G ~ pretreated, data = SBS_sign_contr_colon)$p.value,eff.size.wilcox(data=SBS_sign_contr_colon,column1="SBS_COL_G",column2="pretreated"))
wilcox_SBS_COLON_H <- cbind(wilcox.test(SBS_COL_H ~ pretreated, data = SBS_sign_contr_colon)$p.value,eff.size.wilcox(data=SBS_sign_contr_colon,column1="SBS_COL_H",column2="pretreated"))
wilcox_SBS_COLON_I <- cbind(wilcox.test(SBS_COL_I ~ pretreated, data = SBS_sign_contr_colon)$p.value,eff.size.wilcox(data=SBS_sign_contr_colon,column1="SBS_COL_I",column2="pretreated"))
wilcox_SBS_COLON_J <- cbind(wilcox.test(SBS_COL_J ~ pretreated, data = SBS_sign_contr_colon)$p.value,eff.size.wilcox(data=SBS_sign_contr_colon,column1="SBS_COL_J",column2="pretreated"))
colon_SBS_contribution_stats <- rbind(wilcox_SBS_COLON_A,wilcox_SBS_COLON_B,wilcox_SBS_COLON_C,wilcox_SBS_COLON_D,wilcox_SBS_COLON_E,wilcox_SBS_COLON_F,wilcox_SBS_COLON_G,wilcox_SBS_COLON_H,wilcox_SBS_COLON_I,wilcox_SBS_COLON_J)
colnames(colon_SBS_contribution_stats) <- c("P-value","Effect_size")
rownames(colon_SBS_contribution_stats) <-c("SBS_COL_A", "SBS_COL_B","SBS_COL_C", "SBS_COL_D","SBS_COL_E", "SBS_COL_F","SBS_COL_G", "SBS_COL_H","SBS_COL_I", "SBS_COL_J")
SBS_sign_contr_colon <- readRDS(signatures,file = "/Users/avanhoeck/hpc/cuppen/projects/P0002_5FU_Healthy/WGS_clones/analysis/Analysis/Data/Sign_analysis/Signatures/MutationPatterns/enovo_SBS_colon_sign_contribution.rds")
overview_data <- as.data.frame(read_xlsx("/Users/avanhoeck/hpc/cuppen/projects/P0002_5FU_Healthy/WGS_clones/analysis/Clinical_info/meta_data.xlsx",sheet = "Sheet1"))
overview_data_colon <- overview_data %>% dplyr::filter(Condition=="Healthy" & tissue =="Colon" & WGS_approach=="Organoid") %>%  dplyr::filter(!is.na(sample_name_R)) %>%  dplyr::select(sample_name_R,donor_id,pretreated)
DBS_sign_contr_colon <- readRDS(signatures,file = "/Users/avanhoeck/hpc/cuppen/projects/P0002_5FU_Healthy/WGS_clones/analysis/Analysis/Data/Sign_analysis/Signatures/MutationPatterns/enovo_DBS_colon_sign_contribution.rds")
SBS_sign_contr_liver <- readRDS(signatures,file = "/Users/avanhoeck/hpc/cuppen/projects/P0002_5FU_Healthy/WGS_clones/analysis/Analysis/Data/Sign_analysis/Signatures/MutationPatterns/enovo_SBS_liver_sign_contribution.rds")
DBS_sign_contr_liver <- readRDS(signatures,file = "/Users/avanhoeck/hpc/cuppen/projects/P0002_5FU_Healthy/WGS_clones/analysis/Analysis/Data/Sign_analysis/Signatures/MutationPatterns/enovo_DBS_liver_sign_contribution.rds")
overview_data <- as.data.frame(read_xlsx("/Users/avanhoeck/hpc/cuppen/projects/P0002_5FU_Healthy/WGS_clones/analysis/Clinical_info/meta_data.xlsx",sheet = "Sheet1"))
overview_data_colon <- overview_data %>% dplyr::filter(Condition=="Healthy" & tissue =="Colon" & WGS_approach=="Organoid") %>%  dplyr::filter(!is.na(sample_name_R)) %>%  dplyr::select(sample_name_R,donor_id,pretreated)
SBS_sign_contr_colon <- SBS_sign_contr_colon %>% tibble::rownames_to_column("sample_name_R")
SBS_sign_contr_colon <- left_join(overview_data_colon,SBS_sign_contr_colon,by="sample_name_R")
DBS_sign_contr_colon <- left_join(overview_data_colon,DBS_sign_contr_colon,by="sample_name_R")
wilcox_SBS_COLON_A <- cbind(wilcox.test(SBS_COL_A ~ pretreated, data = SBS_sign_contr_colon)$p.value,eff.size.wilcox(data=SBS_sign_contr_colon,column1="SBS_COL_A",column2="pretreated"))
wilcox_SBS_COLON_B <- cbind(wilcox.test(SBS_COL_B ~ pretreated, data = SBS_sign_contr_colon)$p.value,eff.size.wilcox(data=SBS_sign_contr_colon,column1="SBS_COL_B",column2="pretreated"))
wilcox_SBS_COLON_C <- cbind(wilcox.test(SBS_COL_C ~ pretreated, data = SBS_sign_contr_colon)$p.value,eff.size.wilcox(data=SBS_sign_contr_colon,column1="SBS_COL_C",column2="pretreated"))
wilcox_SBS_COLON_D <- cbind(wilcox.test(SBS_COL_D ~ pretreated, data = SBS_sign_contr_colon)$p.value,eff.size.wilcox(data=SBS_sign_contr_colon,column1="SBS_COL_D",column2="pretreated"))
wilcox_SBS_COLON_E <- cbind(wilcox.test(SBS_COL_E ~ pretreated, data = SBS_sign_contr_colon)$p.value,eff.size.wilcox(data=SBS_sign_contr_colon,column1="SBS_COL_E",column2="pretreated"))
wilcox_SBS_COLON_F <- cbind(wilcox.test(SBS_COL_F ~ pretreated, data = SBS_sign_contr_colon)$p.value,eff.size.wilcox(data=SBS_sign_contr_colon,column1="SBS_COL_F",column2="pretreated"))
wilcox_SBS_COLON_G <- cbind(wilcox.test(SBS_COL_G ~ pretreated, data = SBS_sign_contr_colon)$p.value,eff.size.wilcox(data=SBS_sign_contr_colon,column1="SBS_COL_G",column2="pretreated"))
wilcox_SBS_COLON_H <- cbind(wilcox.test(SBS_COL_H ~ pretreated, data = SBS_sign_contr_colon)$p.value,eff.size.wilcox(data=SBS_sign_contr_colon,column1="SBS_COL_H",column2="pretreated"))
wilcox_SBS_COLON_I <- cbind(wilcox.test(SBS_COL_I ~ pretreated, data = SBS_sign_contr_colon)$p.value,eff.size.wilcox(data=SBS_sign_contr_colon,column1="SBS_COL_I",column2="pretreated"))
wilcox_SBS_COLON_J <- cbind(wilcox.test(SBS_COL_J ~ pretreated, data = SBS_sign_contr_colon)$p.value,eff.size.wilcox(data=SBS_sign_contr_colon,column1="SBS_COL_J",column2="pretreated"))
colon_SBS_contribution_stats <- rbind(wilcox_SBS_COLON_A,wilcox_SBS_COLON_B,wilcox_SBS_COLON_C,wilcox_SBS_COLON_D,wilcox_SBS_COLON_E,wilcox_SBS_COLON_F,wilcox_SBS_COLON_G,wilcox_SBS_COLON_H,wilcox_SBS_COLON_I,wilcox_SBS_COLON_J)
colnames(colon_SBS_contribution_stats) <- c("P-value","Effect_size")
rownames(colon_SBS_contribution_stats) <-c("SBS_COL_A", "SBS_COL_B","SBS_COL_C", "SBS_COL_D","SBS_COL_E", "SBS_COL_F","SBS_COL_G", "SBS_COL_H","SBS_COL_I", "SBS_COL_J")
wilcox_DBS_COLON_A <- cbind(wilcox.test(DBS_COL_A ~ pretreated, data = DBS_sign_contr_colon)$p.value,eff.size.wilcox(data=DBS_sign_contr_colon,column1="DBS_COL_A",column2="pretreated"))
wilcox_DBS_COLON_B <- cbind(wilcox.test(DBS_COL_B ~ pretreated, data = DBS_sign_contr_colon)$p.value,eff.size.wilcox(data=DBS_sign_contr_colon,column1="DBS_COL_B",column2="pretreated"))
wilcox_DBS_COLON_C <- cbind(wilcox.test(DBS_COL_C ~ pretreated, data = DBS_sign_contr_colon)$p.value,eff.size.wilcox(data=DBS_sign_contr_colon,column1="DBS_COL_C",column2="pretreated"))
wilcox_DBS_COLON_D <- cbind(wilcox.test(DBS_COL_D ~ pretreated, data = DBS_sign_contr_colon)$p.value,eff.size.wilcox(data=DBS_sign_contr_colon,column1="DBS_COL_D",column2="pretreated"))
wilcox_DBS_COLON_E <- cbind(wilcox.test(DBS_COL_E ~ pretreated, data = DBS_sign_contr_colon)$p.value,eff.size.wilcox(data=DBS_sign_contr_colon,column1="DBS_COL_E",column2="pretreated"))
wilcox_DBS_COLON_F <- cbind(wilcox.test(DBS_COL_F ~ pretreated, data = DBS_sign_contr_colon)$p.value,eff.size.wilcox(data=DBS_sign_contr_colon,column1="DBS_COL_F",column2="pretreated"))
colon_DBS_contribution_stats <- rbind(wilcox_DBS_COLON_A,wilcox_DBS_COLON_B,wilcox_DBS_COLON_C,wilcox_DBS_COLON_D,wilcox_DBS_COLON_E,wilcox_DBS_COLON_F)
colnames(colon_SBS_contribution_stats) <- c("P-value","Effect_size")
rownames(colon_SBS_contribution_stats) <-c("DBS_COL_A", "DBS_COL_B","DBS_COL_C", "DBS_COL_D","DBS_COL_E", "DBS_COL_F")
overview_data <- as.data.frame(read_xlsx("/Users/avanhoeck/hpc/cuppen/projects/P0002_5FU_Healthy/WGS_clones/analysis/Clinical_info/meta_data.xlsx",sheet = "Sheet1"))
overview_data_liver <- overview_data %>% dplyr::filter(Condition=="Healthy" & tissue =="Liver" & WGS_approach=="Organoid") %>%  dplyr::filter(!is.na(sample_name_R)) %>%  dplyr::select(sample_name_R,donor_id,pretreated)
SBS_sign_contr_liver <- left_join(overview_data_liver,SBS_sign_contr_liver,by="sample_name_R")
wilcox_SBS_liver_A <- cbind(wilcox.test(SBS_LIV_A ~ pretreated, data = SBS_sign_contr_liver)$p.value,eff.size.wilcox(data=SBS_sign_contr_liver,column1="SBS_LIV_A",column2="pretreated"))
wilcox_SBS_liver_B <- cbind(wilcox.test(SBS_LIV_B ~ pretreated, data = SBS_sign_contr_liver)$p.value,eff.size.wilcox(data=SBS_sign_contr_liver,column1="SBS_LIV_B",column2="pretreated"))
wilcox_SBS_liver_C <- cbind(wilcox.test(SBS_LIV_C ~ pretreated, data = SBS_sign_contr_liver)$p.value,eff.size.wilcox(data=SBS_sign_contr_liver,column1="SBS_LIV_C",column2="pretreated"))
wilcox_SBS_liver_D <- cbind(wilcox.test(SBS_LIV_D ~ pretreated, data = SBS_sign_contr_liver)$p.value,eff.size.wilcox(data=SBS_sign_contr_liver,column1="SBS_LIV_D",column2="pretreated"))
wilcox_SBS_liver_E <- cbind(wilcox.test(SBS_LIV_E ~ pretreated, data = SBS_sign_contr_liver)$p.value,eff.size.wilcox(data=SBS_sign_contr_liver,column1="SBS_LIV_E",column2="pretreated"))
wilcox_SBS_liver_F <- cbind(wilcox.test(SBS_LIV_F ~ pretreated, data = SBS_sign_contr_liver)$p.value,eff.size.wilcox(data=SBS_sign_contr_liver,column1="SBS_LIV_F",column2="pretreated"))
wilcox_SBS_liver_G <- cbind(wilcox.test(SBS_LIV_G ~ pretreated, data = SBS_sign_contr_liver)$p.value,eff.size.wilcox(data=SBS_sign_contr_liver,column1="SBS_LIV_G",column2="pretreated"))
wilcox_SBS_liver_H <- cbind(wilcox.test(SBS_LIV_H ~ pretreated, data = SBS_sign_contr_liver)$p.value,eff.size.wilcox(data=SBS_sign_contr_liver,column1="SBS_LIV_H",column2="pretreated"))
wilcox_SBS_liver_I <- cbind(wilcox.test(SBS_LIV_I ~ pretreated, data = SBS_sign_contr_liver)$p.value,eff.size.wilcox(data=SBS_sign_contr_liver,column1="SBS_LIV_I",column2="pretreated"))
wilcox_SBS_liver_J <- cbind(wilcox.test(SBS_LIV_J ~ pretreated, data = SBS_sign_contr_liver)$p.value,eff.size.wilcox(data=SBS_sign_contr_liver,column1="SBS_LIV_J",column2="pretreated"))
wilcox_SBS_liver_K <- cbind(wilcox.test(SBS_LIV_K ~ pretreated, data = SBS_sign_contr_liver)$p.value,eff.size.wilcox(data=SBS_sign_contr_liver,column1="SBS_LIV_K",column2="pretreated"))
wilcox_SBS_liver_L <- cbind(wilcox.test(SBS_LIV_L ~ pretreated, data = SBS_sign_contr_liver)$p.value,eff.size.wilcox(data=SBS_sign_contr_liver,column1="SBS_LIV_L",column2="pretreated"))
wilcox_SBS_liver_M <- cbind(wilcox.test(SBS_LIV_M ~ pretreated, data = SBS_sign_contr_liver)$p.value,eff.size.wilcox(data=SBS_sign_contr_liver,column1="SBS_LIV_M",column2="pretreated"))
liver_SBS_contribution_stats <- rbind(wilcox_SBS_liver_A,wilcox_SBS_liver_B,wilcox_SBS_liver_C,wilcox_SBS_liver_D,wilcox_SBS_liver_E,wilcox_SBS_liver_F,wilcox_SBS_liver_G,wilcox_SBS_liver_H,wilcox_SBS_liver_I,wilcox_SBS_liver_J,wilcox_SBS_liver_K,wilcox_SBS_liver_L,wilcox_SBS_liver_M)
colnames(liver_SBS_contribution_stats) <- c("P-value","Effect_size")
rownames(liver_SBS_contribution_stats) <-c("SBS_LIV_A", "SBS_LIV_B","SBS_LIV_C", "SBS_LIV_D","SBS_LIV_E", "SBS_LIV_F","SBS_LIV_G", "SBS_LIV_H","SBS_LIV_I", "SBS_LIV_J", "SBS_LIV_K","SBS_LIV_L", "SBS_LIV_M")
overview_data_liver <- overview_data %>% dplyr::filter(Condition=="Healthy" & tissue =="Liver" & WGS_approach=="Organoid") %>%  dplyr::filter(!is.na(sample_name_R)) %>%  dplyr::select(sample_name_R,donor_id,pretreated)
DBS_sign_contr_liver <- left_join(overview_data_liver,DBS_sign_contr_liver,by="sample_name_R")
wilcox_DBS_liver_A <- cbind(wilcox.test(DBS_LIV_A ~ pretreated, data = DBS_sign_contr_liver)$p.value,eff.size.wilcox(data=DBS_sign_contr_liver,column1="DBS_LIV_A",column2="pretreated"))
wilcox_DBS_liver_B <- cbind(wilcox.test(DBS_LIV_B ~ pretreated, data = DBS_sign_contr_liver)$p.value,eff.size.wilcox(data=DBS_sign_contr_liver,column1="DBS_LIV_B",column2="pretreated"))
wilcox_DBS_liver_C <- cbind(wilcox.test(DBS_LIV_C ~ pretreated, data = DBS_sign_contr_liver)$p.value,eff.size.wilcox(data=DBS_sign_contr_liver,column1="DBS_LIV_C",column2="pretreated"))
wilcox_DBS_liver_D <- cbind(wilcox.test(DBS_LIV_D ~ pretreated, data = DBS_sign_contr_liver)$p.value,eff.size.wilcox(data=DBS_sign_contr_liver,column1="DBS_LIV_D",column2="pretreated"))
wilcox_DBS_liver_E <- cbind(wilcox.test(DBS_LIV_E ~ pretreated, data = DBS_sign_contr_liver)$p.value,eff.size.wilcox(data=DBS_sign_contr_liver,column1="DBS_LIV_E",column2="pretreated"))
wilcox_DBS_liver_F <- cbind(wilcox.test(DBS_LIV_F ~ pretreated, data = DBS_sign_contr_liver)$p.value,eff.size.wilcox(data=DBS_sign_contr_liver,column1="DBS_LIV_F",column2="pretreated"))
liver_DBS_contribution_stats <- rbind(wilcox_DBS_liver_A,wilcox_DBS_liver_B,wilcox_DBS_liver_C,wilcox_DBS_liver_D,wilcox_DBS_liver_E,wilcox_DBS_liver_F)
colnames(liver_DBS_contribution_stats) <- c("P-value","Effect_size")
rownames(liver_DBS_contribution_stats) <-c("DBS_LIV_A", "DBS_LIV_B","DBS_LIV_C", "DBS_LIV_D","DBS_LIV_E", "DBS_LIV_F")
liver_SBS_contribution_stats
DBS_sign_contr_liver <- readRDS(signatures,file = "/Users/avanhoeck/hpc/cuppen/projects/P0002_5FU_Healthy/WGS_clones/analysis/Analysis/Data/Sign_analysis/Signatures/MutationPatterns/enovo_DBS_liver_sign_contribution.rds")
DBS_sign_contr_liver
overview_data_liver <- overview_data %>% dplyr::filter(Condition=="Healthy" & tissue =="Liver" & WGS_approach=="Organoid") %>%  dplyr::filter(!is.na(sample_name_R)) %>%  dplyr::select(sample_name_R,donor_id,pretreated)
left_join(overview_data_liver,DBS_sign_contr_liver,by="sample_name_R")
DBS_sign_contr_liver <- left_join(overview_data_liver,DBS_sign_contr_liver,by="sample_name_R")
DBS_sign_contr_liver
cbind(wilcox.test(DBS_LIV_A ~ pretreated, data = DBS_sign_contr_liver)$p.value,eff.size.wilcox(data=DBS_sign_contr_liver,column1="DBS_LIV_A",column2="pretreated"))
wilcox_DBS_liver_A <- cbind(wilcox.test(DBS_LIV_A ~ pretreated, data = DBS_sign_contr_liver)$p.value,eff.size.wilcox(data=DBS_sign_contr_liver,column1="DBS_LIV_A",column2="pretreated"))
wilcox_DBS_liver_B <- cbind(wilcox.test(DBS_LIV_B ~ pretreated, data = DBS_sign_contr_liver)$p.value,eff.size.wilcox(data=DBS_sign_contr_liver,column1="DBS_LIV_B",column2="pretreated"))
wilcox_DBS_liver_C <- cbind(wilcox.test(DBS_LIV_C ~ pretreated, data = DBS_sign_contr_liver)$p.value,eff.size.wilcox(data=DBS_sign_contr_liver,column1="DBS_LIV_C",column2="pretreated"))
wilcox_DBS_liver_D <- cbind(wilcox.test(DBS_LIV_D ~ pretreated, data = DBS_sign_contr_liver)$p.value,eff.size.wilcox(data=DBS_sign_contr_liver,column1="DBS_LIV_D",column2="pretreated"))
wilcox_DBS_liver_E <- cbind(wilcox.test(DBS_LIV_E ~ pretreated, data = DBS_sign_contr_liver)$p.value,eff.size.wilcox(data=DBS_sign_contr_liver,column1="DBS_LIV_E",column2="pretreated"))
wilcox_DBS_liver_F <- cbind(wilcox.test(DBS_LIV_F ~ pretreated, data = DBS_sign_contr_liver)$p.value,eff.size.wilcox(data=DBS_sign_contr_liver,column1="DBS_LIV_F",column2="pretreated"))
liver_DBS_contribution_stats <- rbind(wilcox_DBS_liver_A,wilcox_DBS_liver_B,wilcox_DBS_liver_C,wilcox_DBS_liver_D,wilcox_DBS_liver_E,wilcox_DBS_liver_F)
colnames(liver_DBS_contribution_stats) <- c("P-value","Effect_size")
rownames(liver_DBS_contribution_stats) <-c("DBS_LIV_A", "DBS_LIV_B","DBS_LIV_C", "DBS_LIV_D","DBS_LIV_E", "DBS_LIV_F")
colon_SBS_contribution_stats
rbind(colon_SBS_contribution_stats,colon_DBS_contribution_stats)
colon_DBS_contribution_stats <- rbind(wilcox_DBS_COLON_A,wilcox_DBS_COLON_B,wilcox_DBS_COLON_C,wilcox_DBS_COLON_D,wilcox_DBS_COLON_E,wilcox_DBS_COLON_F)
colnames(colon_SBS_contribution_stats) <- c("P-value","Effect_size")
rownames(colon_SBS_contribution_stats) <-c("DBS_COL_A", "DBS_COL_B","DBS_COL_C", "DBS_COL_D","DBS_COL_E", "DBS_COL_F")
colon_SBS_contribution_stats <- rbind(wilcox_SBS_COLON_A,wilcox_SBS_COLON_B,wilcox_SBS_COLON_C,wilcox_SBS_COLON_D,wilcox_SBS_COLON_E,wilcox_SBS_COLON_F,wilcox_SBS_COLON_G,wilcox_SBS_COLON_H,wilcox_SBS_COLON_I,wilcox_SBS_COLON_J)
colnames(colon_SBS_contribution_stats) <- c("P-value","Effect_size")
rownames(colon_SBS_contribution_stats) <-c("SBS_COL_A", "SBS_COL_B","SBS_COL_C", "SBS_COL_D","SBS_COL_E", "SBS_COL_F","SBS_COL_G", "SBS_COL_H","SBS_COL_I", "SBS_COL_J")
colon_DBS_contribution_stats <- rbind(wilcox_DBS_COLON_A,wilcox_DBS_COLON_B,wilcox_DBS_COLON_C,wilcox_DBS_COLON_D,wilcox_DBS_COLON_E,wilcox_DBS_COLON_F)
colnames(colon_DBS_contribution_stats) <- c("P-value","Effect_size")
rownames(colon_DBS_contribution_stats) <-c("DBS_COL_A", "DBS_COL_B","DBS_COL_C", "DBS_COL_D","DBS_COL_E", "DBS_COL_F")
liver_SBS_contribution_stats
liver_DBS_contribution_stats
rbind(colon_SBS_contribution_stats,colon_DBS_contribution_stats)
colon <- rbind(colon_SBS_contribution_stats,colon_DBS_contribution_stats)
liver <- rbind(liver_SBS_contribution_stats,liver_DBS_contribution_stats)
statfinal <- rbind(colon,liver)
statfinal
statfinal <- tibble::rownames_to_column(statfinal, "De_novo_sign")
statfinal
statfinal %>% dplyr::separate(De_novo_sign)
statfinal %>% tidyr::separate(De_novo_sign)
statfinal
statfinal %>% dplyr::mutate(tosplit = statfinal) %>% tidyr::separate(tosplit, c("sampleId", "eventype"))
statfinal %>% dplyr::mutate(tosplit = statfinal)
statfinal
statfinal <- tibble::rownames_to_column(statfinal, "De_novo_sign")
statfinal %>% dplyr::mutate(tosplit = De_novo_sign)
statfinal <- rbind(colon,liver)
str(statfinal)
statfinal %>% as.data.frame() %>% tibble::rownames_to_column( "De_novo_sign")
statfinal %>% as.data.frame() %>% tibble::rownames_to_column( "De_novo_sign") %>% dplyr::mutate(tosplit = De_novo_sign)
statfinal %>% as.data.frame() %>% tibble::rownames_to_column( "De_novo_sign") %>% dplyr::mutate(tosplit = De_novo_sign) %>% tidyr::separate(tosplit, c("sampleId", "eventype","test"))
statfinal %>% as.data.frame() %>% tibble::rownames_to_column( "De_novo_sign") %>% dplyr::mutate(tosplit = De_novo_sign) %>% tidyr::separate(tosplit, c("Mut_type", "Tissue","Sign_Number"))
statfinal %>% as.data.frame() %>% tibble::rownames_to_column( "De_novo_sign") %>%  %>% dplyr::mutate(Pvalue.log10= -log10(P-value) %>% dplyr::mutate(tosplit = De_novo_sign) %>% tidyr::separate(tosplit, c("Mut_type", "Tissue","Sign_Number"))
statfinal <- statfinal %>% as.data.frame() %>% tibble::rownames_to_column( "De_novo_sign") %>% dplyr::mutate(Pvalue.log10= -log10(P-value) %>% dplyr::mutate(tosplit = De_novo_sign) %>% tidyr::separate(tosplit, c("Mut_type", "Tissue","Sign_Number"))
statfinal <- statfinal %>% as.data.frame() %>% tibble::rownames_to_column( "De_novo_sign") %>% dplyr::mutate(Pvalue.log10= -log10(P-value)) %>% dplyr::mutate(tosplit = De_novo_sign) %>% tidyr::separate(tosplit, c("Mut_type", "Tissue","Sign_Number"))
statfinal <- statfinal %>% as.data.frame() %>% tibble::rownames_to_column( "De_novo_sign") %>% dplyr::mutate(Pvalue.log10= -log10(P-value)) %>% dplyr::mutate(tosplit = De_novo_sign) %>% tidyr::separate(tosplit, c("Mut_type", "Tissue","Sign_Number"))
statfinal %>% as.data.frame() %>% tibble::rownames_to_column( "De_novo_sign") %>% dplyr::mutate(Pvalue.log10 = -log10(P-value))
statfinal %>% as.data.frame() %>% tibble::rownames_to_column( "De_novo_sign")
statfinal %>% as.data.frame() %>% tibble::rownames_to_column( "De_novo_sign") %>% dplyr::mutate(Pvalue.log10 = -log10(P-value))
statfinal %>% as.data.frame() %>% tibble::rownames_to_column( "De_novo_sign") %>% dplyr::mutate(Pvalue.log10 = -log10(`P-value`))
statfinal <- rbind(colon,liver)
statfinal <- statfinal %>% as.data.frame() %>% tibble::rownames_to_column( "De_novo_sign") %>% dplyr::mutate(Pvalue.log10 = -log10(`P-value`)) %>% dplyr::mutate(tosplit = De_novo_sign) %>% tidyr::separate(tosplit, c("Mut_type", "Tissue","Sign_Number"))
ggplot(statfinal, aes(x= Effect_size, y= Pvalue.log10))+
geom_point(aes(shape = Mut_type , colour=Tissue),size=5) +
#geom_text(aes(label=sign_ID),hjust=1, vjust=1)+
scale_shape_manual(values = c("SBS"=16,"DBS"=17),name="Mutation type") +
scale_colour_manual(values = c("COL"="#ef8a62","LIV"="#67a9cf"),name="Tissue")
